<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:security="http://www.springframework.org/schema/security"
             xsi:schemaLocation="
                                http://www.springframework.org/schema/beans
                                http://www.springframework.org/schema/beans/spring-beans.xsd
                                http://www.springframework.org/schema/security
                                http://www.springframework.org/schema/security/spring-security-3.1.xsd">

<!--<security:global-method-security secured-annotations="enabled" /> -->


       <http auto-config="true" >
           <intercept-url pattern="/css/**" access="ROLE_ADMIN"/>
           <intercept-url pattern='/user/login.htm*' access="IS_AUTHENTICATED_ANONYMOUSLY"/>
           <intercept-url pattern="/user/login.jsp*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
           <intercept-url pattern="/advertisement/post.htm*" access="ROLE_ADMIN" />
           <intercept-url pattern="/advertisement/placing.htm*" access="ROLE_USER" />
           <intercept-url pattern='/advertisement/**' access='ROLE_USER, ROLE_ADMIN, IS_AUTHENTICATED_ANONYMOUSLY'  />
           <intercept-url pattern="/user/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />

           <form-login login-page='/user/login.html'
                                default-target-url='/advertisement/list.html'
                                always-use-default-target='true'
                                authentication-failure-url="/login-failure" />

           <logout logout-url="/user/logout"
                            logout-success-url="/logoutSuccess.html" />

      </http>

    <authentication-manager alias="authenticationManager"/>

    <user-service>
        <user name="jimi" password="jim" authorities="ROLE_USER, ROLE_ADMIN" />
        <user name="bob" password="bob" authorities="ROLE_USER" />
    </user-service>
        <!-- <form-login />login-page="/user/login.html"/-->

        <!--
    <http auto-config='true'>
        <intercept-url pattern='/user/login.htm*' access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <intercept-url pattern="/advertisement/*" access="ROLE_USER, ROLE_ADMIN, IS_AUTHENTICATED_ANONYMOUSLY"/>
        <intercept-url pattern='/**' access='ROLE_USER'  />

        <form-login login-page="/user/login.html"
                    default-target-url='/advertisement/list.html'
                    always-use-default-target='true'/>

        <form-login />
    </http> -->
    <!--
    <authentication-manager>
        <authentication-provider>
            <user-service>
                <user name="jimi" password="jimispassword" authorities="ROLE_ADMIN" />
                <user name="bob" password="bobspassword" authorities="ROLE_USER" />
            </user-service>
        </authentication-provider>
    </authentication-manager>-->




   <!-- -->
    <!--
    <security:authentication-manager>
        <security:authentication-provider user-service-ref='myUserDetailsService'> -->
    <!--        <security:password-encoder hash="sha"><security:salt-source user-property="username"/></security:password-encoder>-->
   <!--         <security:jdbc-user-service data-source-ref="dataSource"/>
        </security:authentication-provider>
    </security:authentication-manager>
                                                                                      -->



    <!--UserDetailsServiceRetrieves implementation which retrieves the user details (username, password, enabled flag, and authorities) from a database using JDBC queries.-->

    <!--<bean id="myUserDetailsService"
                class="org.springframework.security.core.userdetails.jdbc.JdbcDaoImpl">
        <property name="dataSource" ref="dataSource"/>
    </bean>                                                                              -->



    <!--<security:authentication-manager>
        <security:authentication-provider >
            <security:jdbc-user-service data-source-ref="dataSource" />
        </security:authentication-provider>

    </security:authentication-manager>-->



</beans:beans>
                